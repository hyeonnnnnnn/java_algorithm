133027
-- 코드를 입력하세요
SELECT FLAVOR
FROM (
    SELECT FH.FLAVOR , SUM(FH.TOTAL_ORDER) +SUM(J.TOTAL_ORDER) AS TOTAL
    FROM FIRST_HALF FH INNER JOIN JULY J ON 
                  (FH.FLAVOR = J.FLAVOR )
    GROUP BY FH.FLAVOR 
    ORDER BY TOTAL DESC
)
WHERE ROWNUM <=3



132204
-- 코드를 입력하세요
SELECT AP.APNT_NO, P.PT_NAME, P.PT_NO,AP.MCDP_CD,D.DR_NAME,AP.APNT_YMD
FROM APPOINTMENT AP INNER JOIN  PATIENT P ON (AP.PT_NO =P.PT_NO) 
   INNER JOIN DOCTOR D ON (AP.MDDR_ID =D.DR_ID)
WHERE  TO_CHAR(AP.APNT_YMD,'YYYY-MM-DD') = '2022-04-13' --4/13일 
AND AP.APNT_CNCL_YN ='N' --취소되지 않은 
AND AP.MCDP_CD = 'CS' --흉부외과
ORDER BY AP.APNT_YMD



131537
-- 코드를 입력하세요
SELECT * FROM (
    SELECT TO_CHAR(SALES_DATE,'YYYY-MM-DD') AS SALES_DATE, PRODUCT_ID,USER_ID ,SALES_AMOUNT
    FROM ONLINE_SALE
    WHERE TO_CHAR(SALES_DATE,'YYYYMM')='202203'
    
    UNION ALL 
    
    SELECT  TO_CHAR(SALES_DATE,'YYYY-MM-DD') AS SALES_DATE, PRODUCT_ID,NULL AS USER_ID ,SALES_AMOUNT
    FROM OFFLINE_SALE
    WHERE EXTRACT(YEAR FROM SALES_DATE) = '2022' AND EXTRACT(MONTH FROM SALES_DATE) = '03' --WHERE TO_CHAR(SALES_DATE,'YYYYMM')='202203'
)
ORDER BY SALES_DATE, PRODUCT_ID, USER_ID;



131532

SELECT EXTRACT(YEAR FROM OS.SALES_DATE) AS YEAR, 
       EXTRACT(MONTH FROM OS.SALES_DATE) AS MONTH, 
       UI.GENDER, 
       COUNT(DISTINCT UI.USER_ID) AS USERS
FROM USER_INFO UI 
INNER JOIN  ONLINE_SALE OS 
ON(UI.USER_ID = OS.USER_ID)
WHERE UI.GENDER IS NOT NULL
GROUP BY  EXTRACT(YEAR FROM OS.SALES_DATE), 
          EXTRACT(MONTH FROM OS.SALES_DATE),
          UI.GENDER
ORDER BY YEAR, MONTH, GENDER



131124

SELECT A.MEMBER_NAME,  B.REVIEW_TEXT, TO_CHAR(B.REVIEW_DATE,'YYYY-MM-DD')
FROM MEMBER_PROFILE A 
INNER JOIN  REST_REVIEW B ON(A.MEMBER_ID = B.MEMBER_ID)
WHERE B.MEMBER_ID IN (
                SELECT  MEMBER_ID
                FROM REST_REVIEW 
                WHERE 1=1
                GROUP BY  MEMBER_ID 
                HAVING COUNT(*) = (SELECT MAX(COUNT(*))
                                   FROM REST_REVIEW 
                                   WHERE 1=1
                                   GROUP BY MEMBER_ID)
                 )
ORDER BY B.REVIEW_DATE ASC
